---
title: "Conflictos territoriales en la cobertura de La Nación"
author:
  - name: "Curso IIDyPCA"
format:
  html:
    toc: true
    number-sections: true
---

```{r}
library(tidyverse)
library(lubridate)
noticias <- read_csv("../datos/noticias_politica_geocodificadas.csv", show_col_types = FALSE)
```

# Introducción

Este paper reproducible acompaña el módulo avanzado. Se basa en el scraping de la sección de política y sintetiza los conflictos territoriales detectados mediante reglas simples y NER.

# Datos y método

```{r}
noticias |>
  select(id_nota, fecha, titulo, categoria, provincia) |>
  head()
```

La limpieza se realiza con `scripts/run_all.R`, la geocodificación con `scripts/geocodificacion_tidygeocoder.R` y el reconocimiento de entidades con `scripts/ner_spacyr.R`.

# Resultados descriptivos

```{r}
noticias |>
  mutate(mes = floor_date(fecha, "month")) |>
  count(mes, categoria) |>
  ggplot(aes(mes, n, color = categoria)) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(title = "Notas por mes y categoría", x = "Mes", y = "Cantidad")
```

```{r}
noticias |>
  count(provincia, sort = TRUE)
```

# Mapa de ubicaciones

```{r}
library(sf)
library(ggplot2)
```

```{r}
world <- map_data("world")

noticias |>
  ggplot() +
  geom_polygon(data = world, aes(long, lat, group = group), fill = "grey95", color = "grey80") +
  geom_point(aes(lon, lat, size = 1, color = categoria), alpha = 0.8) +
  theme_void() +
  labs(title = "Ubicaciones mencionadas", color = "Categoría")
```

# Discusión y próximas tareas

- Integrar pesos muestrales para ponderar provincias.
- Afinar la heurística de clasificación temática con modelos supervisados.
- Conectar la base DuckDB con el dashboard Shiny para actualizaciones en vivo.

# Reproducibilidad

1. Ejecutar `scripts/run_all.R` para obtener la materia prima.
2. Correr `scripts/geocodificacion_tidygeocoder.R` y `scripts/ner_spacyr.R` si se desean coordenadas y entidades.
3. Renderizar este documento con `quarto render informe/paper_lanacion_conflicto.qmd`.
